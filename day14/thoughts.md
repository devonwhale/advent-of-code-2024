I was out all day yesterday so only just getting round to this. A fun novel one but i'm going to need to give it some proper thought before I can solve part two. I'm going to leave this spinning on a background thread for now

Update: Well, a bit of manual observation got me there pretty quickly. Really enjoy that sort of puzzle